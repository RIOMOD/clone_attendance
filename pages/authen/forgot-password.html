<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quên mật khẩu - Hệ thống Chấm Công CTSV</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon.ico">

    <!-- Preload fonts for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Google Fonts - Professional fonts for attendance system -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Main merged CSS file -->
    <link rel="stylesheet" href="merged-forgot-password.css">

    <!-- SEO Meta Tags -->
    <meta name="description"
        content="Khôi phục mật khẩu cho hệ thống chấm công CTSV - Lấy lại quyền truy cập tài khoản">
    <meta name="keywords" content="quên mật khẩu, khôi phục, CTSV, chấm công, reset password">

    <!-- PWA Support -->
    <meta name="theme-color" content="#2563eb">
    <link rel="manifest" href="../../manifest.json">
</head>

<body>
    <!-- Background animated elements -->
    <div class="bg-animation">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
            <div class="shape shape-5"></div>
        </div>
    </div>

    <!-- Main container -->
    <div class="login-container">
        <!-- Breadcrumb Navigation -->
        <div class="breadcrumb-nav">
            <a href="../../index.html" class="breadcrumb-link">
                <i class="fas fa-home"></i>
                <span>Trang chủ</span>
            </a>
            <i class="fas fa-chevron-right breadcrumb-separator"></i>
            <a href="login-professional.html" class="breadcrumb-link">Đăng nhập</a>
            <i class="fas fa-chevron-right breadcrumb-separator"></i>
            <span class="breadcrumb-current">Quên mật khẩu</span>
        </div>

        <!-- Left side - Branding & Info -->
        <div class="login-branding">
            <div class="brand-content">
                <!-- Logo and title -->
                <div class="brand-header">
                    <div class="logo-container">
                        <i class="fas fa-key brand-icon"></i>
                        <div class="brand-text">
                            <h1 class="brand-title">Khôi phục mật khẩu</h1>
                            <p class="brand-subtitle">Lấy lại quyền truy cập tài khoản</p>
                        </div>
                    </div>
                </div>

                <!-- Recovery features -->
                <div class="features-list">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="feature-content">
                            <h3>Bảo mật tuyệt đối</h3>
                            <p>Xác thực đa lớp với mã hóa đầu cuối</p>
                        </div>
                    </div>

                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="feature-content">
                            <h3>Nhanh chóng</h3>
                            <p>Khôi phục mật khẩu chỉ trong vài phút</p>
                        </div>
                    </div>

                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <div class="feature-content">
                            <h3>Đa thiết bị</h3>
                            <p>Thực hiện trên mọi thiết bị di động và máy tính</p>
                        </div>
                    </div>
                </div>

                <!-- Process steps -->
                <div class="process-steps">
                    <div class="step-item active" id="step1">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h3>Nhập email</h3>
                            <p>Cung cấp địa chỉ email đã đăng ký</p>
                        </div>
                    </div>

                    <div class="step-item" id="step2">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>Xác thực</h3>
                            <p>Kiểm tra email và nhập mã xác thực</p>
                        </div>
                    </div>

                    <div class="step-item" id="step3">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>Mật khẩu mới</h3>
                            <p>Tạo mật khẩu mới cho tài khoản</p>
                        </div>
                    </div>
                </div>

                <!-- Stats container -->
                <div class="stats-container">
                    <div class="stat-item">
                        <span class="stat-number">99.9%</span>
                        <span class="stat-label">Thành công</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">&lt;2min</span>
                        <span class="stat-label">Thời gian</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">24/7</span>
                        <span class="stat-label">Hỗ trợ</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right side - Forgot Password Form -->
        <div class="login-form-container">
            <div class="login-form-wrapper">
                <!-- Back to login link -->
                <div class="back-link">
                    <a href="login-professional.html" class="back-btn">
                        <i class="fas fa-arrow-left"></i>
                        <span>Quay lại đăng nhập</span>
                    </a>
                </div>

                <!-- Form header -->
                <div class="form-header">
                    <div class="welcome-back">
                        <h2 class="form-title">Quên mật khẩu?</h2>
                        <p class="form-subtitle">Đừng lo lắng, chúng tôi sẽ giúp bạn khôi phục</p>
                    </div>

                    <!-- Time display -->
                    <div class="current-time">
                        <div class="time-display" id="currentTime"></div>
                        <div class="date-display" id="currentDate"></div>
                    </div>
                </div>

                <!-- Multi-step form container -->
                <div class="multi-step-container">
                    <!-- Step 1: Email Input -->
                    <form id="emailForm" class="step-form active" data-step="1">
                        <div class="step-header">
                            <i class="fas fa-envelope step-icon"></i>
                            <h3>Nhập địa chỉ email</h3>
                            <p>Chúng tôi sẽ gửi mã xác thực đến email của bạn</p>
                        </div>

                        <div class="form-group">
                            <label for="forgotEmail" class="form-label">
                                <i class="fas fa-envelope"></i>
                                <span>Địa chỉ Email</span>
                            </label>
                            <div class="input-container">
                                <input type="email" id="forgotEmail" name="email" class="form-input"
                                    placeholder="Nhập email đã đăng ký" required autocomplete="email"
                                    aria-describedby="email-error">
                                <div class="input-border"></div>
                            </div>
                            <div id="email-error" class="error-message"></div>
                        </div>

                        <!-- Demo emails suggestion -->
                        <div class="demo-emails">
                            <p class="demo-label">Hoặc thử với email demo:</p>
                            <div class="demo-email-list">
                                <button type="button" class="demo-email-btn" data-email="admin@ctsv.edu.vn">
                                    admin@ctsv.edu.vn
                                </button>
                                <button type="button" class="demo-email-btn" data-email="manager@ctsv.edu.vn">
                                    manager@ctsv.edu.vn
                                </button>
                                <button type="button" class="demo-email-btn" data-email="user@ctsv.edu.vn">
                                    user@ctsv.edu.vn
                                </button>
                            </div>
                        </div>

                        <button type="submit" class="login-btn" id="sendCodeBtn">
                            <span class="btn-text">Gửi mã xác thực</span>
                            <div class="btn-loading">
                                <div class="loading-spinner"></div>
                            </div>
                            <i class="fas fa-paper-plane btn-icon"></i>
                        </button>
                    </form>

                    <!-- Step 2: Verification Code -->
                    <form id="verificationForm" class="step-form" data-step="2">
                        <div class="step-header">
                            <i class="fas fa-shield-alt step-icon"></i>
                            <h3>Nhập mã xác thực</h3>
                            <p>Mã 6 chữ số đã được gửi đến <span id="sentToEmail"></span></p>
                        </div>

                        <div class="form-group">
                            <label for="verificationCode" class="form-label">
                                <i class="fas fa-key"></i>
                                <span>Mã xác thực</span>
                            </label>
                            <div class="verification-input-container">
                                <input type="text" class="verification-digit" maxlength="1" data-index="0">
                                <input type="text" class="verification-digit" maxlength="1" data-index="1">
                                <input type="text" class="verification-digit" maxlength="1" data-index="2">
                                <input type="text" class="verification-digit" maxlength="1" data-index="3">
                                <input type="text" class="verification-digit" maxlength="1" data-index="4">
                                <input type="text" class="verification-digit" maxlength="1" data-index="5">
                            </div>
                            <div id="verification-error" class="error-message"></div>
                        </div>

                        <!-- Timer and resend -->
                        <div class="verification-actions">
                            <div class="timer-container">
                                <i class="fas fa-clock"></i>
                                <span>Mã hết hiệu lực sau: </span>
                                <span id="countdown" class="countdown">15:00</span>
                            </div>
                            <button type="button" class="resend-btn" id="resendBtn" disabled>
                                <i class="fas fa-redo"></i>
                                <span>Gửi lại mã</span>
                            </button>
                        </div>

                        <button type="submit" class="login-btn" id="verifyCodeBtn">
                            <span class="btn-text">Xác thực</span>
                            <div class="btn-loading">
                                <div class="loading-spinner"></div>
                            </div>
                            <i class="fas fa-check btn-icon"></i>
                        </button>
                    </form>

                    <!-- Step 3: New Password -->
                    <form id="newPasswordForm" class="step-form" data-step="3">
                        <div class="step-header">
                            <i class="fas fa-lock step-icon"></i>
                            <h3>Tạo mật khẩu mới</h3>
                            <p>Mật khẩu phải có ít nhất 8 ký tự và bao gồm chữ hoa, chữ thường, số</p>
                        </div>

                        <div class="form-group">
                            <label for="newPassword" class="form-label">
                                <i class="fas fa-lock"></i>
                                <span>Mật khẩu mới</span>
                            </label>
                            <div class="input-container password-container">
                                <input type="password" id="newPassword" name="newPassword" class="form-input"
                                    placeholder="Nhập mật khẩu mới" required aria-describedby="password-error">
                                <button type="button" class="password-toggle" id="newPasswordToggle">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <div class="input-border"></div>
                            </div>
                            <div id="password-error" class="error-message"></div>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword" class="form-label">
                                <i class="fas fa-lock"></i>
                                <span>Xác nhận mật khẩu</span>
                            </label>
                            <div class="input-container password-container">
                                <input type="password" id="confirmPassword" name="confirmPassword" class="form-input"
                                    placeholder="Nhập lại mật khẩu mới" required
                                    aria-describedby="confirm-password-error">
                                <button type="button" class="password-toggle" id="confirmPasswordToggle">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <div class="input-border"></div>
                            </div>
                            <div id="confirm-password-error" class="error-message"></div>
                        </div>

                        <!-- Password strength indicator -->
                        <div class="password-strength">
                            <div class="strength-label">Độ mạnh mật khẩu:</div>
                            <div class="strength-bar">
                                <div class="strength-fill" id="strengthFill"></div>
                            </div>
                            <div class="strength-text" id="strengthText">Yếu</div>
                        </div>

                        <!-- Password requirements -->
                        <div class="password-requirements">
                            <div class="requirement-item" id="req-length">
                                <i class="fas fa-times"></i>
                                <span>Ít nhất 8 ký tự</span>
                            </div>
                            <div class="requirement-item" id="req-lowercase">
                                <i class="fas fa-times"></i>
                                <span>Chứa chữ thường (a-z)</span>
                            </div>
                            <div class="requirement-item" id="req-uppercase">
                                <i class="fas fa-times"></i>
                                <span>Chứa chữ hoa (A-Z)</span>
                            </div>
                            <div class="requirement-item" id="req-number">
                                <i class="fas fa-times"></i>
                                <span>Chứa số (0-9)</span>
                            </div>
                        </div>

                        <button type="submit" class="login-btn" id="resetPasswordBtn">
                            <span class="btn-text">Đặt lại mật khẩu</span>
                            <div class="btn-loading">
                                <div class="loading-spinner"></div>
                            </div>
                            <i class="fas fa-save btn-icon"></i>
                        </button>
                    </form>
                </div>

                <!-- Footer links -->
                <div class="form-footer">
                    <div class="footer-links">
                        <a href="login-professional.html" class="footer-link">
                            <i class="fas fa-sign-in-alt"></i>
                            Đăng nhập
                        </a>
                        <a href="register-professional.html" class="footer-link">
                            <i class="fas fa-user-plus"></i>
                            Đăng ký
                        </a>
                        <a href="../../index.html" class="footer-link">
                            <i class="fas fa-home"></i>
                            Trang chủ
                        </a>
                    </div>

                    <div class="divider">
                        <span>Hoặc</span>
                    </div>

                    <div class="help-section">
                        <p class="help-text">
                            <i class="fas fa-question-circle"></i>
                            Gặp khó khăn trong việc khôi phục tài khoản?
                        </p>
                        <div class="help-actions">
                            <a href="tel:1900-1234" class="help-link">
                                <i class="fas fa-phone"></i>
                                Gọi hỗ trợ: 1900 1234
                            </a>
                            <a href="mailto:support@ctsv.edu.vn" class="help-link">
                                <i class="fas fa-envelope"></i>
                                Email: support@ctsv.edu.vn
                            </a>
                            <button type="button" class="help-link" onclick="openModal('termsModal')">
                                <i class="fas fa-file-contract"></i>
                                Điều khoản sử dụng
                            </button>
                            <button type="button" class="help-link" onclick="openModal('privacyModal')">
                                <i class="fas fa-shield-alt"></i>
                                Chính sách bảo mật
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Terms of Service Modal -->
    <div id="termsModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="termsTitle"
        onclick="closeModal('termsModal')" onkeydown="handleModalKeydown(event)" tabindex="-1">
        <div class="modal-content" onclick="event.stopPropagation()" onkeydown="event.stopPropagation()"
            role="document">
            <div class="modal-header">
                <h2 id="termsTitle"><i class="fas fa-file-contract"></i> Điều khoản sử dụng</h2>
                <button class="close-btn" onclick="closeModal('termsModal')" aria-label="Đóng modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="terms-section">
                    <h3>1. Phạm vi áp dụng</h3>
                    <p>Điều khoản này áp dụng cho tất cả người dùng của Hệ thống Chấm Công CTSV, bao gồm sinh viên,
                        giảng viên và cán bộ quản lý.</p>
                </div>

                <div class="terms-section">
                    <h3>2. Quyền và nghĩa vụ của người dùng</h3>
                    <ul>
                        <li>Người dùng có trách nhiệm bảo mật thông tin đăng nhập</li>
                        <li>Sử dụng hệ thống đúng mục đích, không gây tổn hại đến hệ thống</li>
                        <li>Báo cáo ngay lập tức khi phát hiện lỗ hổng bảo mật</li>
                        <li>Tuân thủ các quy định nội bộ của trường và pháp luật Việt Nam</li>
                    </ul>
                </div>

                <div class="terms-section">
                    <h3>3. Chính sách sử dụng dữ liệu</h3>
                    <p>Dữ liệu chấm công được thu thập, xử lý và lưu trữ theo đúng quy định pháp luật về bảo vệ dữ liệu
                        cá nhân. Chúng tôi cam kết không chia sẻ thông tin cá nhân với bên thứ ba không có sự đồng ý của
                        người dùng.</p>
                </div>

                <div class="terms-section">
                    <h3>4. Trách nhiệm của nhà cung cấp</h3>
                    <ul>
                        <li>Đảm bảo hệ thống hoạt động ổn định 99.9% thời gian</li>
                        <li>Bảo mật thông tin người dùng theo tiêu chuẩn quốc tế</li>
                        <li>Cung cấp hỗ trợ kỹ thuật 24/7</li>
                        <li>Thông báo trước khi có thay đổi quan trọng</li>
                    </ul>
                </div>

                <div class="terms-section">
                    <h3>5. Điều khoản chấm dứt</h3>
                    <p>Hệ thống có quyền tạm dừng hoặc chấm dứt tài khoản nếu người dùng vi phạm điều khoản sử dụng hoặc
                        có hành vi gây tổn hại đến hệ thống.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('termsModal')">Đóng</button>
                <button class="btn-primary" onclick="acceptTerms()">Đồng ý</button>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="privacyTitle"
        onclick="closeModal('privacyModal')" onkeydown="handleModalKeydown(event)" tabindex="-1">
        <div class="modal-content" onclick="event.stopPropagation()" onkeydown="event.stopPropagation()"
            role="document">
            <div class="modal-header">
                <h2 id="privacyTitle"><i class="fas fa-shield-alt"></i> Chính sách bảo mật</h2>
                <button class="close-btn" onclick="closeModal('privacyModal')" aria-label="Đóng modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="privacy-section">
                    <h3>1. Thông tin thu thập</h3>
                    <p>Chúng tôi thu thập các thông tin sau:</p>
                    <ul>
                        <li>Thông tin cá nhân: Họ tên, email, số điện thoại, MSSV/MSGV</li>
                        <li>Dữ liệu chấm công: Thời gian vào/ra, vị trí check-in</li>
                        <li>Thông tin thiết bị: IP address, loại thiết bị, trình duyệt</li>
                        <li>Dữ liệu sử dụng: Tần suất truy cập, tính năng sử dụng</li>
                    </ul>
                </div>

                <div class="privacy-section">
                    <h3>2. Mục đích sử dụng</h3>
                    <ul>
                        <li>Quản lý điểm danh và chấm công chính xác</li>
                        <li>Tạo báo cáo thống kê cho ban quản lý</li>
                        <li>Cải thiện chất lượng dịch vụ</li>
                        <li>Liên lạc thông báo quan trọng</li>
                        <li>Bảo mật và phòng chống gian lận</li>
                    </ul>
                </div>

                <div class="privacy-section">
                    <h3>3. Bảo mật thông tin</h3>
                    <p>Chúng tôi áp dụng các biện pháp bảo mật tiên tiến:</p>
                    <ul>
                        <li>Mã hóa SSL/TLS cho tất cả kết nối</li>
                        <li>Xác thực đa yếu tố (2FA)</li>
                        <li>Giám sát bảo mật 24/7</li>
                        <li>Sao lưu dữ liệu định kỳ</li>
                        <li>Kiểm tra bảo mật thường xuyên</li>
                    </ul>
                </div>

                <div class="privacy-section">
                    <h3>4. Quyền của người dùng</h3>
                    <p>Bạn có quyền:</p>
                    <ul>
                        <li>Truy cập và xem thông tin cá nhân được lưu trữ</li>
                        <li>Yêu cầu chỉnh sửa thông tin không chính xác</li>
                        <li>Yêu cầu xóa dữ liệu cá nhân (trừ dữ liệu bắt buộc)</li>
                        <li>Rút lại sự đồng ý xử lý dữ liệu</li>
                        <li>Khiếu nại về việc xử lý dữ liệu</li>
                    </ul>
                </div>

                <div class="privacy-section">
                    <h3>5. Liên hệ</h3>
                    <p>Mọi thắc mắc về chính sách bảo mật, vui lòng liên hệ:</p>
                    <ul>
                        <li>Email: privacy@ctsv.edu.vn</li>
                        <li>Hotline: 1900-1234</li>
                        <li>Địa chỉ: Phòng CTSV, Tầng 2, Nhà A1</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('privacyModal')">Đóng</button>
                <button class="btn-primary" onclick="acceptPrivacy()">Đã hiểu</button>
            </div>
        </div>
    </div>

    <!-- Success/Error notifications -->
    <div id="notification" class="notification"></div>

    <!-- Main JavaScript files -->
    <script src="login-professional.js"></script>
    <script src="forgot-password.js"></script>
</body>

</html>